<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> CMP++ | Omar Kahol </title> <meta name="author" content="Omar Kahol"> <meta name="description" content="A library for the Bayesian calibration of computer codes using sequential and adaptive approaches."> <meta name="keywords" content="Electrohydrodynamics, Corona Thruster, Aircraft icing, Uncertainty Quantification, Bayesian Methods"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://omarkahol.github.io/projects/5_project/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Omar </span> Kahol </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">CMP++</h1> <p class="post-description">A library for the Bayesian calibration of computer codes using sequential and adaptive approaches.</p> </header> <article> <div class="repo p-2 text-center"> <a href="https://github.com/omarkahol/cmp" rel="external nofollow noopener" target="_blank"> <img class="repo-img-light w-100" alt="omarkahol/cmp" src="https://github-readme-stats.vercel.app/api/pin/?username=omarkahol&amp;repo=cmp&amp;theme=default&amp;show_owner=false"> <img class="repo-img-dark w-100" alt="omarkahol/cmp" src="https://github-readme-stats.vercel.app/api/pin/?username=omarkahol&amp;repo=cmp&amp;theme=dark&amp;show_owner=false"> </a> </div> <hr> <header class="post-header"> <h1 class="post-title">Technical documentation <a href="../../assets/pdf/projects/cmp/cmp.pdf" target="_blank" rel="noopener noreferrer" class="float-right"><i class="fas fa-file-pdf"></i></a> </h1> <p class="post-description">The document containing the technical documentation for the library, install instructions and a test case.</p> </header> <hr> <p>CMP++ is a c++ library for the calibration of computer codes using Bayesian methods. It supports the use of a full bayesian solution, sequential approaches and modular approaches. In the following sections I will introduce different aspects of the calibration problem and show how the CMP method works.</p> <p>The following section briefly discusses the Bayesian calibration framework.</p> \[\newcommand{\cmp}{\text{CMP}} \newcommand{\fmp}{\text{FMP}} \newcommand{\koh}{\text{KOH}} \newcommand{\map}{\text{MAP}} \newcommand{\reals}{\mathbb{R}} \newcommand{\btheta}{\boldsymbol{\theta}} \newcommand{\bx}{\boldsymbol{x}} \newcommand{\bt}{\boldsymbol{t}} \newcommand{\bz}{\boldsymbol{z}} \newcommand{\bY}{\boldsymbol{\mathcal{Y}}} \newcommand{\bres}{\boldsymbol{R}_{\btheta}} \newcommand{\bpsi}{\boldsymbol{\psi}} \newcommand{\beps}{\boldsymbol{\epsilon}} \newcommand{\balpha}{\boldsymbol{\alpha}} \newcommand{\rr}{\bres^T \bres} \newcommand{\bphi}{\boldsymbol{\phi}_{\boldsymbol{\theta}}} \newcommand{\gpmean}{\mu_{\boldsymbol{\psi}_z}} \newcommand{\gpcov}{c_{\boldsymbol{\psi}_z}} \newcommand{\detf}[1]{\mid #1 \mid} \newcommand{\muh}{\hat{\mu}} \newcommand{\data}{\boldsymbol{\mathcal{D}}} \newcommand{\model}{\mathcal{M}} \newcommand{\yobs}{\boldsymbol{y}_{\text{obs}}} \newcommand{\xobs}{\boldsymbol{x}_{\text{obs}}} \newcommand{\Yobs}{\boldsymbol{\mathcal{Y}}_{\text{obs}}} \newcommand{\kernel}{K_{\boldsymbol{\psi}}} \newcommand{\summ}[3]{\displaystyle \sum_{#1=#2}^{#3}} \newcommand{\dd}{\text{d}} \newcommand{\intpsi}[1]{\displaystyle\int_{\Psi} \ #1 \ \text{d} \boldsymbol{\psi}} \newcommand{\intphi}[1]{\displaystyle\int_{\Phi} \ #1 \ \text{d} \boldsymbol{\phi}} \newcommand{\intt}[1]{\displaystyle \int_{\Theta} \ #1 \ \text{d} \boldsymbol{\theta}} \newcommand{\likelihood}[1]{\mathcal{L}\left( #1\right)} \newcommand{\prior}[1]{\pi \left( #1\right)} \newcommand{\p}[1]{\text{p} \left( #1 \right)} \newcommand{\pq}[1]{\text{q} \left( #1 \right)} \newcommand{\normalpdf}{\mathcal{N}} \newcommand{\approxp}[2]{\hat{\text{p}}_{#1} \left( #2 \right)} \newcommand{\argp}[2]{\text{p}_{_{#1}} \left( #2 \right)} \newcommand{\psimap}{\boldsymbol{\psi}_{_\text{MAP}} \left( \boldsymbol{\theta} \right)} \newcommand{\phimap}{\boldsymbol{\phi}_{_\text{MAP}} \left( \boldsymbol{\theta} \right)} \newcommand{\psikoh}{\boldsymbol{\psi}_{_\text{KOH}}} \newcommand{\Stheta}{S_{\btheta}} \newcommand{\hessian}[1]{\mathcal{H}_{#1}} \DeclareMathOperator*{\argmax}{arg\,max} \newcommand{\expectation}[2]{\mathbb{E}_{#1} \left[ \ #2 \ \right]} \newcommand{\trace}[1]{\text{trace} \left( #1 \right)}\] <h2 id="bayesian-calibration-framework">Bayesian calibration framework</h2> <p>Let \(y\) be the output of a scalar computer model, \(\model\) which depends on some coordinates, \(\bx \in X \subset \reals^{d_x}\) and some parameters, \(\btheta \in \Theta \subset \reals^p\) so that</p> \[\begin{equation} y = \model(\bx, \btheta) \; . \end{equation}\] <p>The objective of model calibration is, given a set of n experiments \(\data = \left\{ \xobs^i, y^i \right\}_{i = 1 \ldots n}\) to compute a plausible value (or distribution) of the model parameters.</p> <p>To do so, one needs to define a proper statistical model that explains the observations. As standard in many calibration studies, we model the observations, \(\yobs = \left\{ y^i \right\}_{i = 1 \ldots n}\) as a set of iid random variables, \(\Yobs\) that are explained by the following statistical model:</p> \[\begin{equation} \Yobs = \boldsymbol{\model} + \bz + \beps \;, \label{eq:stat_model} \end{equation}\] <p>where we have denoted with \(\beps\) and \(\bz\) two random vectors that are representatives of the measurement and model errors, respectively. The random vector \(\boldsymbol{\model}\) contains the output of the computer model at each observation, \(\boldsymbol{\model} = \left\{\model(\xobs^i, \btheta) \right\}_{i=1 \ldots n}\). Measurement noise is considered to follow a normal distribution with zero mean and diagonal covariance, \(\beps|_{\sigma_e} \sim \normalpdf(0, \, \sigma_e^2 \ \mathbb{I}_n)\). The model discrepancy term is usually modeled with a Gaussian Process \(\bz |_{\bpsi_z} \sim \text{GP}(\gpmean,\gpcov)\), where \(\gpmean\) and \(\gpcov\) are, respectively, the mean and covariance function of the process. It is suggested to have \(\gpmean(x) = 0\) for better identifiability. We denote with hyper-parameters the variables \(\bpsi = (\bpsi_z, \sigma_e) \subset \reals^h\) that describe experimental and model errors. In the literature, one can find different expressions of Eq. \ref{eq:stat_model} that can account also for data inconsistency or multiplicative experimental error.</p> <p>According to the frequentist perspective, \(\btheta, \bpsi\) are deterministic variables and one usually constructs a suitable estimator. In the Bayesian perspective these variables make sense only as possible realizations of random variables, \(\boldsymbol{\Theta}, \boldsymbol{\Psi}\). Under this framework, one tries to compute the posterior distribution, \(\p{\btheta, \bpsi \mid \data, \model}\), which is defined as the joint PDF of \(\boldsymbol{\Theta}, \boldsymbol{\Psi}\) conditioned on the realized experiments and the model choice. This can be done using Bayes’ rule:</p> \[\begin{equation} \p{\bpsi, \btheta | \data, \model} = \dfrac{\likelihood{\data \mid \btheta, \bpsi, \model } \ \prior{\bpsi, \btheta \mid \model}}{\p{\data \mid \model}} \; . \label{eq:posterior} \end{equation}\] <p>The term \(\prior{\bpsi, \btheta \mid \model}\) is called prior and represents the knowledge of the distribution of the parameters before observing the data. The prior can be non-informative or informative and particular care must be taken to define a proper prior function since the results can be strongly affected by it.</p> <p>The term \(\likelihood{\data \mid \btheta, \bpsi, \model }\) is called likelihood and, because of the assumptions made, it is a multivariate normal distribution:</p> \[\begin{equation} \log \likelihood{\data \mid \btheta, \bpsi, \model } = - \dfrac{n}{2} \log 2 \pi - \dfrac{n}{2} \detf{\kernel + \sigma_e^2 \mathbb{I}_n} -\dfrac{1}{2} \bres^T (\kernel + \sigma_e^2 \mathbb{I}_n)^{-1} \bres \; , \label{eq:ll} \end{equation}\] <p>where we indicated with \(\bres\) the vector containing the residuals, \(\bres=\yobs - \boldsymbol{\model}\), and with \(\kernel\) the covariance matrix obtained from the structure of the model error terms, \((\kernel)_{i,j} = \gpcov (\xobs^i, \ \xobs^j)\).</p> <p>Finally, the denominator in Eq. \ref{eq:posterior} is usually called model evidence and appears as a normalization constant for the posterior distribution:</p> \[\begin{equation} \p{\data \mid \model} = \intt{\intpsi{\likelihood{\data \mid \btheta, \bpsi, \model } \ \prior{\bpsi, \btheta \mid \model}}} \;. \label{eq:model_evidence} \end{equation}\] <p>Once the posterior PDF is available, it can be used to make predictions at a new coordinate, \(\bx^*\). The calibrated model prediction is the probability distribution associated with the evaluation of the computer model at the new point, \(\mathcal{Y}_{\text{cal}}^* \sim \p{y_{\text{cal}}^* \mid \data}\) and can be computed using</p> \[\begin{equation} \p{y_{\text{cal}}^* \mid \data,\model} = \intt{\p{y_{\text{cal}}^* \mid \btheta, \data,\model} \ \p{\btheta \mid \data,\model}} \; . \label{eq:cal_pred} \end{equation}\] <p>Because the computer model is deterministic, \(\p{y_{\text{cal}}^* \mid \btheta, \data, \model} = \delta (y_{\text{cal}}^* - \model(\bx^*, \btheta))\). In some cases the computer model, if too expensive to evaluate, can be substituted with a cheaper surrogate. The latter is usually a Gaussian Process so the associated uncertainty must be taken into account. In this derivation we used the parameters’ posterior,</p> \[\begin{equation} \p{\btheta \mid \data, \model} = \intpsi{\p{\btheta, \bpsi \mid \data, \model}} \;, \label{eq:par_posterior} \end{equation}\] <p>which is the marginal posterior distribution of the model parameters.</p> <p>The corrected model prediction regards the probability distribution associated with the prediction of the computer model and model error term at a new point, \(\mathcal{Y}_{\text{corr}}^* \sim \p{y_{\text{corr}}^* \mid \data, \model}\). Similarly, the distribution can be computed using the rule of marginalization:</p> \[\begin{equation} \p{y_{\text{corr}}^* \mid \data,\model} = \intt{\intpsi{\p{y_{\text{corr}}^* \mid \btheta, \bpsi_z, \data,\model} \ \p{\btheta, \bpsi_z \mid \data,\model}}} \; . \label{eq:corr_pred} \end{equation}\] <p>In this case, the distribution \(\p{y_{\text{corr}}^* \mid \btheta, \bpsi_z, \data,\model}\) is normal with mean and variance specified by the Gaussian process predictive equations:</p> \[\begin{equation} \left. \begin{aligned} \mathcal{Y}_{\text{corr}}^*|_{\btheta,\bpsi_z,\data,\model} \sim&amp; \normalpdf (\mu_\text{pred}, \sigma_\text{pred}^2) \; ,\\ &amp;\mu_\text{pred} = \model (\bx^*, \btheta) + k_*^T \ \kernel^{-1} \ \bres \;,\\ &amp;\sigma_\text{pred}^2 = \kernel - k_*^T \ \kernel^{-1} \ k_*^T \;. \end{aligned} \right. \end{equation}\] <p>Where \((k_*^T)_i = \gpcov(\bx^*,\xobs^i)\). We remark that, in both cases, the experimental noise random variable can be included if the prediction required concerns the value of a new experiment.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Omar Kahol. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>