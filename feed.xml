<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://omarkahol.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://omarkahol.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-03-29T18:18:44+00:00</updated><id>https://omarkahol.github.io/feed.xml</id><title type="html">blank</title><subtitle>Personal website. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">2D thin airfoil theory with unsteady b.c.</title><link href="https://omarkahol.github.io/blog/2024/2d_thin_airfoil_theory/" rel="alternate" type="text/html" title="2D thin airfoil theory with unsteady b.c."/><published>2024-03-27T15:12:00+00:00</published><updated>2024-03-27T15:12:00+00:00</updated><id>https://omarkahol.github.io/blog/2024/2d_thin_airfoil_theory</id><content type="html" xml:base="https://omarkahol.github.io/blog/2024/2d_thin_airfoil_theory/"><![CDATA[<p>The following blog post develops a theory for the lift and moment coefficient of an aerofoil undergoing unsteady motion in a fluid. We will assume that the flow is inviscid and 2D; moreover, we will completely neglect the dynamics of the airflow and hence consider only the unsteadiness in the boundary conditions. The airfoil is considered thin (to be further discussed later) and undergoing small oscillations in a flowing fluid. The term small refers to the magnitude of such oscillations when compared to the magnitude of the mean flow itself. The largest limitation of this theory is that it neglects the dynamics of the air when it reacts to a change in the boundary conditions. Such effect is well captured by more complex unsteady models such as Wagner or Theodorsen. At the conclusion of this article, more space is dedicated to a discussion about what is missing and how the dynamics of the air should be incorporated. On the other hand, the mathematics that we will develop in this blogpost is interesting and rather complex and worthy of presentation. In addition, it can be used as a foundation upon which more complex theories will be developed.</p> <hr/> \[\newcommand{\muh}{\hat{\mu}} \newcommand{\summ}[3]{\displaystyle \sum_{#1=#2}^{#3}} \newcommand{\dd}{\text{d}} \newcommand{\qt}{\tilde{q}} \newcommand{\var}{\text{var}} \newcommand{\cov}{\text{cov}} \newcommand{\vh}{\hat{V}}\] <h3 id="introduction">Introduction</h3> <p>We consider an airfoil that is udergoing a pitching and heaving motion around a particular point, denoted by fulcrum. The setup is conviniently depicted in the following image</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2d_th/drawing_bc-480.webp 480w,/assets/img/posts/2d_th/drawing_bc-800.webp 800w,/assets/img/posts/2d_th/drawing_bc-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2d_th/drawing_bc.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="problem setup" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>The airfoil has a chord of \(2b\) and is immersed in a flow parallel to the x-axis with magnitude \(U_{\infty}\). The motion can be decomposed into a pitching motion, \(\theta\) reprents the angle, and a heaving motion, where \(h\) represents a distance from a fixed point.</p> <h3 id="linearized-description-of-the-motion">Linearized description of the motion</h3> <p>We now ask how we can describe the motion of the airfoil. As commonly done in airfoil theory, we describe the airfoil surface with two curves, the upper one \(y_0^u(x)\) and the lower one \(y_0^l(x)\) (here \(y_0\) refers to the initial condition, i.e. when \(h=0\) and \(\theta=0\)). A point in this surface will move by a certain displacement \(u(x,t)\), which should describe the rotation and displacement around the fulcrum.</p> \[\begin{equation} y(x,t) = y_0(x,t) + u(x,t) \;. \end{equation}\] <p>If we assume that the displacements are small enough then we can write</p> \[\begin{equation} u(x,t) = h(t) + (ab-x) \theta(t) \;. \end{equation}\] <p>The key result is that, if we use \(y_0\) as reference surface, the displacement of a point is equivalent to a dispalcement of a flat plate. The displacement in the x direction is negligible.</p> <p>This is equivalent to a small perturbation in the velocity field of the airfoil</p> \[\begin{equation} \dot{u}(x,t) = h(t) + (ab-x) \theta(t) \;. \end{equation}\] <h3 id="linearized-boundary-conditions">Linearized boundary conditions</h3> <p>The no-peneratration boundary condition imposes that the normal component of the velocity at the boundary is zero. This means that if we indicate with \(v = (v_x, v_y)\) the velocity of the body, \(w=(w_x,w_y)\) the airflow velocity and \(n\) the normal vector perpendicular to the surface of the airfoil at every point, the no penetration boundary condition reads</p> \[\begin{equation} n^T \ w = n^T v \; . \end{equation}\] <p>We now take a virtual perturbation around a rest condition i.e. \(w=w_0+ \Delta w\). The new equation reads</p> \[\begin{equation} \left. \begin{aligned} &amp;n_0^T w_0 + n_0^T \Delta w + w_0^T\Delta n = n_0^T v_0 + n_0^T \Delta v + v_0^T\Delta n \\ &amp;n_0^T \Delta w + w_0^T\Delta n = n_0^T \Delta v \; . \end{aligned} \right. \end{equation}\] <p>The reader should confirm that the order zero term cancels because when the airfoil is at rest the boundary condition is automatically respected and that \(v_0 = 0\) for definition. This gives the linearized version of the boundary condtion that the airflow should repect. Assuming \(w_0 = (U_{\infty},0)\) the only object that requires care is the normal vector. For a generic function \(y(x)\) a perpendicular outward-pointing vector is \((-y'(x),1)\) (where the negative sign ensures that it points upwards),</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2d_th/normal-480.webp 480w,/assets/img/posts/2d_th/normal-800.webp 800w,/assets/img/posts/2d_th/normal-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2d_th/normal.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="problem setup" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>The above picture should clarify the setup. In reality this vector needs to be normalized in order to be the normal vector \(n(x) = \frac{(-y'(x),1)}{\sqrt{1+y'(x)^2}}\). Actually this can be reprsented by a vector a divided by its norm \(n_0 = \dfrac{a}{(a^Ta)^{1/2}}\). One should check that</p> \[\begin{equation} \Delta n = \Delta \dfrac{a}{(a^T a)^{1/2}} = (I - n_0 n_0^T) \dfrac{\Delta a}{(a^T a)^{1/2}} \, \end{equation}\] <p>in this particular case we can say that \(a = (-y'(x),1)\) and hence \(a_0 = (-y_0'(x),1)\) and \(\Delta a = (-u'(x),0)=( \theta(t),0)\). The last result is due to the fact that u is a small displacement around the rest condition and hence can be considered as a perturbation.</p> <p>The computations yield</p> \[\begin{equation} n_0^T \Delta w = \dfrac{\dot{h}+(ab-x)\dot{\theta}}{\sqrt{1+{y_0'}^2}}-\dfrac{U_\infty \theta}{(1+{y_0'}^2)^{3/2}}+\dfrac{U_\infty y_0'(x)}{\sqrt{1+{y_0'}^2}} \;. \label{eq:dw_1} \end{equation}\] <p>Now we assume that the airfoil is infinitely thin and that the boundary conditions can be applied to the mean line. We further assume that \(y_{ml}'(x)\approx 0\) so that we can neglect the denominator in Eq.\ref{eq:dw_1}. Assuming that we can rite the perturbation as \(\Delta w = (w_x,w_y=v)\) the product with the normal vector would yield the scalar \(-w_x y_0'+v\) and the first part can be dropped because it is the product of two small quantities.</p> <p>The final result is reported in the following equation</p> \[\begin{equation} v^{ml} = \dot{h}+(ab-x)\dot{\theta}-U_\infty (\theta(t)+y'_{ml}(x)) \;. \label{eq:dw_2} \end{equation}\] <p>Eq.\ref{eq:dw_2} reports the y component of the perturbation velocity evaluated at the mean line of the airfoil that enforces the linearized non-penetration boundary condition. This perturbation is generated by the airfoil and its movement in the flow. In the next section we show how we can further simplify this problem using Complex Analysis and potential flows.</p> <h3 id="mean-line-condition">Mean Line condition</h3> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2d_th/vortex_flow-480.webp 480w,/assets/img/posts/2d_th/vortex_flow-800.webp 800w,/assets/img/posts/2d_th/vortex_flow-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2d_th/vortex_flow.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="problem setup" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>We now assume that the perturbation velocity is induced by a vortex sheet at \(y=0\) of strength \(j(s)\). To further setup the problem we turn to potential flow and complex analysis. The idea is to write the complex velocity field as a complex number \(w=u-iv\) and use simple flows (uniform, source/sink, vortex, …) to build more complex flows. In our case the flow that we will use is the vortex flow</p> \[\begin{equation} w (z) = \dfrac{\Gamma}{2\pi i} \dfrac{1}{z-s} \;. \end{equation}\] <p>The above formula represents the velocity induced by a line vortex placed at \(z=s\). In our case we have a vortex sheet which can be thought of as a series of infinitesimal vortices with strength \(j(s)\ \dd s\). The induced velocity will be the sum of all the induced velocities</p> \[\begin{equation} w (z) = \dfrac{1}{2\pi i} \int_{-b}^{b} \dfrac{j(s)}{z-s} \ \dd s\;. \end{equation}\] <p>This formula gives the perturbation velocity induced by the vortex sheet at any point s of the complex plane. The vortex strength is unknown but we want it to be the one that enforces the linearized boundary conditions that we derived before. To further simplify the problem we impose the boundary condition not on the mean line but on the line \(y=0\). We can proceed to evaluate it in the x-axis using <a href="https://en.wikipedia.org/wiki/Sokhotski–Plemelj_theorem" target="_blank">Plemelj’s theorem</a></p> \[\begin{equation} \dfrac{w(x,y=0^+)+w(x, y=0^-)}{2} = \dfrac{1}{2\pi i} \text{p.v.}\int_{-b}^{b} \dfrac{j(s)}{x-s} \ \dd s = -i v^{ml}\;. \end{equation}\] <p>Where the p.v. symbol indicates that we have to take the principal value of the integral. This leaves us with a integral equation to solve. This is because we know the expression of \(v^{ml}\) (found by linearizing the b.c., see Eq.\ref{eq:dw_2}) but we do not know the expression of \(j(s)\) which appears under the integral sign.</p> <p>The solution is reported in the following equation</p> \[\begin{equation} w (z) = U_{\infty} -\dfrac{1}{\pi}\sqrt{\dfrac{b-z}{b+z}} \int_{-b}^{b} \sqrt{\dfrac{b+s}{b-s}} \dfrac{v^{ml}(s)}{z-s} \ \dd s\;. \end{equation}\] <p>This gives the whole perturbation velocity field at any point \(z\) that respects the linearized boundary condition.</p> <h3 id="force-and-moment-coefficients">Force and moment coefficients</h3> <p>To compute the force coefficients we will have to compute an integral of a function of the complex velocity field. We will do that using <a href="https://farside.ph.utexas.edu/teaching/336L/Fluidhtml/node91.html" target="_blank">Blasius integrals</a>, but before, it is useful to expand the velocity field in a <a href="https://en.wikipedia.org/wiki/Laurent_series" target="_blank">Laurent series</a>, as this will greatly simplfy the computation of the integrals. The two terms that depend on z expand with</p> \[\begin{equation} \left. \begin{aligned} &amp;\dfrac{1}{z-s} = \dfrac{1}{z}\dfrac{1}{1-z/s} = \dfrac{1}{z} \displaystyle \sum_{n=0}^{+\infty}(\dfrac{s}{z})^n = \dfrac{1}{z}+\dfrac{s}{z^2}+...\\ &amp; \sqrt{\dfrac{b-z}{b+z}} = i\left( 1-\dfrac{b}{z} + ...\right)\; . \end{aligned} \right. \end{equation}\] <p>The Laurent series of the velocity field is therefore</p> \[\begin{equation} \left. \begin{aligned} w (z) = U_{\infty} &amp; - \dfrac{i}{\pi z} \int_{-b}^{b} \sqrt{\dfrac{b+s}{b-s}} \ v^{ml}(s) \ \dd s\\ &amp; -\dfrac{i}{\pi z^2} \int_{-b}^{b} \sqrt{\dfrac{b+s}{b-s}}\ (b-s)\ v^{ml}(s) \ \dd s \\ &amp; + ... \;, \end{aligned} \right. \end{equation}\] <h4 id="lift-coefficient">Lift coefficient</h4> <p>To compute the lift coefficient we will use the first Blasius formula which reads</p> \[\begin{equation} F_x - i F_y = i \dfrac{\rho}{2} \oint_C w^2(z) \dd z \; . \end{equation}\] <p>To compute the integral we will resort to <a href="https://en.wikipedia.org/wiki/Residue_theorem" target="_blank">Cauchy’s residue theorem</a> which allows us to compute the integral by a simple evaluation:</p> \[\begin{equation} \oint_C f(z) \dd z = 2 \pi i \sum \text{res}(f(z))\; . \end{equation}\] <p>This is possible because we have already taken the Laurent series. We should simply evaluate the term in \(w^2\) that contributes to the residual (which is the one that depends on \(z^{-1}\)). The result reads</p> \[\begin{equation} F_y = -2 \rho U_{\infty} \int_{-b}^{b} \sqrt{\dfrac{b+s}{b-s}} \ v^{ml}(s) \ \dd s \; . \end{equation}\] <p>Now we substitute the definition of \(v^{ml}\) from the boundary conditions (see Eq.\ref{eq:dw_2})</p> \[\begin{equation} F_y = -2 \rho U_{\infty} \int_{-b}^{b} \sqrt{\dfrac{b+s}{b-s}} \ \left( \dot{h}+(ab-s)\dot{\theta}-U_\infty (\theta(t)+y'_{ml}(x)) \right) \ \dd s \; . \end{equation}\] <p>This integral should be simplified and the result non-dimensionalized by divinding with \(\rho U_{\infty}^2 b\). After all these simplifications we get the following result</p> \[\begin{equation} C_L = 2 \pi \left( \theta - \dfrac{\dot{h}}{U_\infty} + b \left( \dfrac{1}{2}-a \right)\dfrac{\dot{\theta}}{U_\infty} - \alpha_0 \right) \; . \label{eq:cl} \end{equation}\] <p>Where \(\alpha_0\) is the so-called zero-lift angle of attack and is defined by</p> \[\begin{equation} \alpha_0 = - \dfrac{2}{\pi b} \int_{-b}^{b} \sqrt{\dfrac{b+s}{b-s}} \ y'_{ml}(s) \ \dd s\; , \end{equation}\] <p>and depends by the curvature of the mean line (for a symmetric airfoil it is zero).</p> <h4 id="moment-coefficient">Moment coefficient</h4> <p>The moment coefficient should be computed using, again, Blasius’ formula for the moment which reads</p> \[\begin{equation} M_0 = -\dfrac{\rho}{2} \text{Re}\left[\oint_C z w^2(z) \dd z \right]\; . \end{equation}\] <p>The computations are very similar to the previous part (evaluate the Laurent series for \(w^2(z) z\) and use Cauchy’s theorem) and, after nondimensionalizing with \(2\rho U_\infty^2 b^2\) the result reads</p> \[\begin{equation} C_{M0}= \dfrac{\pi}{2} \left( \dfrac{\dot{h}+ab \dot{\theta}}{U_\infty} - \theta + \beta_0 \right)\; . \end{equation}\] <p>The result is, however, usually reported taking the aerodynamic center (quarter chord) as a reference point. This can be achieved using the moment transport theorem which states that,</p> \[\begin{equation} C_{Mac}= C_{M0} + \dfrac{C_L}{4}\; . \end{equation}\] <p>The final moment coefficient reads</p> \[\begin{equation} C_{Mac}= -\dfrac{\pi}{4} \left( \dfrac{\dot{\theta}}{U_\infty} +2(\alpha_0 - \beta_0) \right)\; . \label{eq:cm} \end{equation}\] <p>In this formula,</p> \[\begin{equation} \beta_0 = - \dfrac{2}{\pi b^2} \int_{-b}^{b} \sqrt{(b+s)(b-s)} \ y'_{ml}(s) \ \dd s\; , \end{equation}\] <h3 id="conclusions">Conclusions</h3> <p>Equations \ref{eq:cl} and \ref{eq:cm} report the lift and moment coefficient for an aerofoil undergoing small oscillatory motion in a mean flow. To compute them we linearized the rather complicated time-dependent boundary condition and generated a potential flow that respects that condition. The largest limitation of this theory is not the linerization itself but rather the fact that we do not consider the dynamics of the air. The perturbation flow is still a potential flow which means that reacts istantaneously to a change of the boundary conditions. This is obviously wrong. But how wrong? The potential flow approximation captures very well the behaviour of the external flow but completely neglects the dynamics of the boundary layer and of the wake. To see how, lets assume that our airfoil is initially not oscillating and, without loss of generality, we assume that it is ymmetric and at zero angle of attack. The airfoil produces no lift and therefore the circulation around it its zero. When the angle of attack is increased the airfoil will start to produce lift (some of that is due to the actual nonzero value of the angle of attack and some to the oscillatory motion \(\dot{\theta}&gt;0\), see Eq. \ref{eq:cl}). This means that the circulation of the airfoil becomes more and more negative. The total circulation must however remain zero. This is no surprise and simply means that some positive circulation is released in the wake. The circulation is not stationary as it moves with the fluid velocity and is therefore transported at \(\infty\) with velocity \(U_\infty\). This process takes time and while the released positive circulation is near the airfoil it will induce some velocity on it thus reducing the effective angle of attack. This means that it takes some time for the airfoil to reach the \(C_L\) value dictated by Eq. \ref{eq:cl} and this is not captured by our model.</p>]]></content><author><name></name></author><category term="Aerodynamics"/><summary type="html"><![CDATA[Lift and moment coefficients for a thin oscillating aerofoil.]]></summary></entry><entry><title type="html">MCMC thinning</title><link href="https://omarkahol.github.io/blog/2024/mcmc_thinning/" rel="alternate" type="text/html" title="MCMC thinning"/><published>2024-02-22T15:12:00+00:00</published><updated>2024-02-22T15:12:00+00:00</updated><id>https://omarkahol.github.io/blog/2024/mcmc_thinning</id><content type="html" xml:base="https://omarkahol.github.io/blog/2024/mcmc_thinning/"><![CDATA[<p>The following blog post analyses the effect of subsampling a Markov chain. Subsampling (or thinning) is a common operation that consists of discarding N samples before saving the next one when sampling an MCMC (Markov Chain Monte Carlo). This is done for two main reasons. First and foremost, it saves memory by reducing the number of samples that have to be analyzed. Moreover; even with a perfect acceptance rate, samples will always be correlated. To ensure independence between samples, they have to be “thinned”; between two saved samples, some samples compatible with the correlation length need to be discarded. Such samples will be then used to construct statistics or estimators so it is natural to ask if subsampling is necessary. If the answer is yes, how much? We will try to answer this question by looking at the quality of the mean estimator as a function of the subsampling ratio.</p> <hr/> \[\newcommand{\muh}{\hat{\mu}} \newcommand{\summ}[3]{\displaystyle \sum_{#1=#2}^{#3}} \newcommand{\dd}{\text{d}} \newcommand{\qt}{\tilde{q}} \newcommand{\var}{\text{var}} \newcommand{\cov}{\text{cov}} \newcommand{\vh}{\hat{V}}\] <p>Assume that we have \(n\) samples \(\{q_i\}_{i&lt;n}\) taken from the realization of a Markov chain that has converged to the stationary distribution \(p(q)\). The expected value of the distribution will be estimated using the sample average in the following way</p> \[\begin{equation} \left. \begin{aligned} &amp; \mu = E(q) = \int_\mathcal{Q} q \ p(q) \, \dd q \; , \\ &amp; \muh = \dfrac{1}{n} \summ{i}{1}{n} q_i \; . \end{aligned} \right. \end{equation}\] <p>Even if the samples are not independent, the expected value of this estimator will be, because of the linearity of the expectation operator:</p> \[\begin{equation} E(\muh) = \dfrac{1}{n}\summ{i}{1}{n} E(q_i) = \mu \; . \end{equation}\] <p>Defining \(\qt_i = q_i - \mu\), we can compute the variance in the following way:</p> \[\begin{equation} \var(\muh) = E\left( (\muh -\mu)^2\right) = E\left( \dfrac{1}{n^2} \summ{i}{1}{n} \qt_i \summ{j}{1}{n} \qt_j\right) \; . \end{equation}\] <p>The product between the sample sum can be decomposed by noting that</p> \[\begin{equation} \left. \begin{aligned} (\qt_1 + \qt_2 + \ldots+ \qt_n)&amp; (\qt_1 + \qt_2 + \ldots + \qt_n)= \\ &amp; \qt_1^2 + \qt_2^2 + \ldots + \qt_n^2 \\ &amp; +2\qt_1 \qt_2 + \ldots + 2\qt_1 \qt_n \\ &amp;+ \ldots + 2 \qt_2 \qt_n \\ &amp; + \ldots \end{aligned} \right. \end{equation}\] <p>Hence,</p> \[\begin{equation} \var(\muh) = \dfrac{1}{n^2} E\left( \summ{i}{1}{n} \qt_i^2 + 2 \summ{i}{1}{n-1}\summ{j}{i+1}{n} \qt_i\qt_j\right) = \dfrac{1}{n^2} \left( \summ{i}{1}{n} E(\qt_i^2) + 2 \summ{i}{1}{n-1}\summ{j}{i+1}{n} E(\qt_i\qt_j) \right) \; . \end{equation}\] <p>And finally,</p> \[\begin{equation} \var(\muh) = \dfrac{\sigma^2}{n} + \dfrac{2}{n^2} \summ{i}{1}{n-1}\summ{j}{i+1}{n} \cov(\qt_i,\qt_j) \; . \label{eq:var} \end{equation}\] <p>We now assume an exponential decay of the covariance between samples,</p> \[\begin{equation} \cov(\qt_i,\qt_j) = \sigma^2 \ \exp\left( -\dfrac{|i-j|}{L}\right) \; , \label{eq:cov} \end{equation}\] <p>where the factor \(\sigma^2\) ensures that when \(i=j\) we retrieve the correct variance and \(L\) is an appropriate correlation length scale. We denote \(k=\mid i-j\mid\) as the lag. Substituting Eq. \ref{eq:cov} into Eq. \ref{eq:var} yields</p> \[\begin{equation} \left. \begin{aligned} \var(\muh) &amp; = \dfrac{\sigma^2}{n} + \dfrac{2}{n^2} \summ{i}{1}{n-1}\summ{k}{1}{n} \exp\left( -\dfrac{k}{L}\right) \\ &amp; = \dfrac{\sigma^2}{n} \left( 1+ 2\frac{n-1}{n} \summ{k}{1}{n} \exp\left( -\dfrac{k}{L}\right) \right)\; . \end{aligned} \right. \end{equation}\] <p>To rewrite the last term we have used the fact that the term inside the exponential does not depend on the running index i. Now we introduce the thinning parameter s which can be an integer value between 1 and n-1. It corresponds to how much the chain is thinned, i.e. we retain 1 every s samples. As an example, when s is equal to 1 we do not discard any sample and we immediately save the next sample. When s is equal to n-1 we accept the first sample and then discard all the subsequent n-1 samples, remaining with just one sample. For the sake of brevity, we also call \(\tilde{n}=\frac{n/s-1}{n/s}\)</p> \[\begin{equation} \var(\muh) = \dfrac{\sigma^2}{n/s} \left( 1+ 2 \tilde{n}\summ{k}{1}{n/s} \exp\left( -\dfrac{k s}{L}\right) \right)\; . \end{equation}\] <p>The sum evaluates to,</p> \[\begin{equation} \summ{k}{1}{n/s} \exp\left( -\dfrac{k s}{L}\right) = \dfrac{e^{-n/L}\left( e^{n/L}-1\right)}{e^{s/L}-1} \; . \end{equation}\] <p>We now compute the ratio between the sample variance and \(L\frac{\sigma^2}{n}\) which has the dimensionality of variance and does not depend on the thinning parameter, \(s\),</p> \[\begin{equation} \dfrac{\var(\muh)}{L \frac{\sigma^2}{n}} = \frac{s}{L} \left( 1 - 2 \tilde{n} \dfrac{1-e^{-n/L}}{1-e^{s/L}} \right)\; . \end{equation}\] <p>We now proceed by looking at the last equation as a function of \(x=s/L\) (which compares the amount of skipping to the correlation length), we call \(c = \tilde{n} \left(1-e^{-n/L} \right)\),</p> \[\begin{equation} f(x) = x \left(1 - 2\dfrac{c}{1-e^x} \right) \; . \end{equation}\] <p>The parameter c is limited by 0 when \(n \rightarrow 0\) or \(L \rightarrow \infty\) and 1 when \(n \rightarrow \infty\) or \(L \rightarrow 0\) (assuming that we still accept a sufficient number of samples so that \(\tilde{n}=1\), otherwise we get a lower value). We call these limits the fully correlated and uncorrelated limits, respectively. We can show that this function is always monotone (for values of c in the range [0,1]). This means that thinning has no beneficial effect on the quality of the estimator. The following graph shows the increase in variance caused by thinning</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/mcmc_thinning/corr1-480.webp 480w,/assets/img/posts/mcmc_thinning/corr1-800.webp 800w,/assets/img/posts/mcmc_thinning/corr1-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/mcmc_thinning/corr1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="correlation" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>On the one hand, subsampling always has a detrimental effect on the quality of the estimator. On the other hand, it is possible to see that this effect is negligible up to \(s/L \approx 1\), meaning that we can still subsample without any negative effect and reduce the dimension of the analyzed samples.<br/> This has a positive effect as we have to analyze and store fewer samples.</p>]]></content><author><name></name></author><category term="Statistics"/><summary type="html"><![CDATA[An analysis of the counter-benefits that arise from thinning or sub-sampling for MCMC]]></summary></entry><entry><title type="html">EHD Equations Scaling with external convection</title><link href="https://omarkahol.github.io/blog/2023/ehd/" rel="alternate" type="text/html" title="EHD Equations Scaling with external convection"/><published>2023-05-12T15:12:00+00:00</published><updated>2023-05-12T15:12:00+00:00</updated><id>https://omarkahol.github.io/blog/2023/ehd</id><content type="html" xml:base="https://omarkahol.github.io/blog/2023/ehd/"><![CDATA[<p>The following blog post extends my dimensionless theory for EHD propulsion in the case of the presence of a strong external convection field.</p> <hr/> <p>The issue of the addition of the mean flow is a crucial aspect to consider when examining the motion of a thruster in relation to a still air volume. It is essential to understand the impact that this addition has on the generated thrust force and the power consumption of the thruster.</p> <p>The velocity, denoted as \(U\), of the moving thruster is determined by the equilibrium condition \(T(U)-D(U)=0\), where \(T(U)\) is the thrust force generated by the thruster and \(D(U)\) is the drag force experienced by the vehicle.</p> <p>It is important to note that analyzing the functional form of \(T(U)\) requires expensive wind tunnel testing. Hence, it is imperative to study what the dimensionless model can tell us about this dependence.</p> <p>To construct suitable reference values for the dimensionless model, the gap is chosen as the main geometric scaling length, and the applied voltage is chosen as the main electrical quantity. The mean flow velocity can be scaled with a \(u_{\infty}\) term that represents the order of magnitude of such velocity.</p> \[\begin{cases} \hat{\nabla} \cdot \hat{E} = \dfrac{\rho_0}{\epsilon_0 \dfrac{V_a}{d^2}}\hat{\rho} \\ \hat{\nabla} \cdot \hat{\rho} \left( \hat{E} + \dfrac{u_{\infty}}{\mu_q \dfrac{V_a}{d}} \hat{u} \right) = 0\\ \hat{u} \cdot \hat{\nabla} \hat{u} = -\dfrac{P_0}{\rho u_{\infty}^2} \hat{\nabla} \hat{P} + \dfrac{\rho_0 V_a}{\rho u_{\infty}^2} \hat{\rho}_q \hat{E} + \dfrac{\nu}{ u_{\infty} d} \hat{\nabla}^2 \hat{u} \end{cases}\] <p>hence</p> \[\begin{cases} \hat{\nabla} \cdot \hat{E} = \hat{\rho} \\ \hat{\nabla} \cdot \left( \hat{E} + R_v \hat{u} \right) = 0\\ \hat{u} \cdot \hat{\nabla} \hat{u} = -\hat{\nabla} \hat{P} +\left( \dfrac{1}{R_v} \dfrac{1}{\mu_q}\sqrt{\dfrac{\epsilon_0}{\rho}} \ \right)^2 \hat{\rho}_q \hat{E} + \dfrac{1}{Re_{\infty}} \hat{\nabla}^2 \hat{u} \end{cases}\] <p>The first dimensionless number, \(R_v\), represents the ratio between the neutral gas and ion velocity and indicates the weight of the convective term in the equations. This number is significant because it helps us understand the importance of the convective term in relation to the other terms in the equations and its effect will be thoroughly explored. The second dimensionless number, \(Re_d\), represents the Reynolds number based on the convective velocity and the gap.</p> <p>Upon examining the velocity ratio dimensionless number, \(R_v\), we can see that it acts as a denominator in the volumetric EHD force. This implies that the addition of a mean flow results in a reduction of the significance of this term.</p> <p>This observation is intuitive since in the still case, it was the collisions between ions and neutral gas that generated the air flow. However, in the presence of a mean flow, the airflow is already present, and the effect of collisions becomes less evident in the equations as the velocity is increased.</p> <p>Therefore, the addition of a mean flow has a damping effect on the volumetric EHD force, making it less significant.</p> <hr/> <p>The dimensionless equations are now simplified in the case of a 1D motion. The conservation of mass in the case of a 1D flow shows that this velocity is equal everywhere in the domain and it is assumed to be equal to its reference value, \(u_{\infty}\). The addition to this hypothesis yields the following drift region equations</p> \[\begin{cases} \dfrac{\partial}{\partial x} \hat{E} = \hat{\rho}_q \\ \dfrac{\partial}{\partial x} \hat{\rho}_q \left( \hat{E} + R_v \right) = 0 \end{cases}\] <p>After integrating the two differential equations over the interval [0,1] and applying Peek’s boundary condition, we obtain an algebraic equation that describes the current density as a function of the dimensionless voltage and the dimensionless velocity ratio.</p> \[1 = \dfrac{-\left(\hat{V}^{-1}+R_v \right)^3+\sqrt{\left(\left(\hat{V}^{-1}+R_v \right)^2+2 \hat{\jmath} \right)^3}}{3\hat{\jmath}} - R_v\] <p>The algebraic equation that describes the current density as a function of the dimensionless voltage and the dimensionless velocity ratio has a rather complex closed-form solution, which is crucial for understanding the behavior of the system since the dimensionless current is equal to the power coefficient. This solution is conveniently presented in the next figure</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ehd_scaling/currdensConv-480.webp 480w,/assets/img/posts/ehd_scaling/currdensConv-800.webp 800w,/assets/img/posts/ehd_scaling/currdensConv-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/ehd_scaling/currdensConv.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="j" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>Upon examining the curves, it becomes apparent that the dimensionless current increases significantly as the effect of the convective term is amplified. This increase can be attributed to the fact that the presence of a mean flow will extract more ions from the ionization region, leading to a higher current consumption. The addition of a mean flow alters the ion flow behavior, resulting in more ions being expelled from the thruster’s ionization region. As a result, a higher current is required to maintain the desired thrust force. This effect is more pronounced at higher values of the dimensionless velocity ratio, indicating that the velocity of the thruster relative to the still air volume has a significant impact on its power consumption.</p> <hr/> <p>The thrust coefficient was defined as the volumetric integral of the thrust density term. In a 1D formulation, this coefficient is equivalent to a surface thrust density and the volumetric integral reduces to a line integral.</p> \[C_T = \int_0^1 \hat{\rho}_q \hat{E} \ \rm{d}\hat{x} = \hat{\jmath} \int_0^1 \dfrac{\hat{E}}{\hat{E} + R_v} \ \rm{d}\hat{x}\] <p>This integral admits a, rather complex, closed-form solution, which is not reported for brevity.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ehd_scaling/CT-480.webp 480w,/assets/img/posts/ehd_scaling/CT-800.webp 800w,/assets/img/posts/ehd_scaling/CT-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/ehd_scaling/CT.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="CT" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>The figure above reports the thrust coefficient functional dependence on the dimensionless voltage for different values of the convective term, \(R_v\). The behavior of this value may be similar to the case of the thruster in the still air as it exhibits similar low and high voltage limits. Increasing the convective term increases the thrust coefficient but this increase is smaller if compared to the power coefficient; moreover, the actual thruster suffers from the addition of aerodynamic drag which increases as the mean flow velocity is increased. The thrust-to-power coefficient is defined as the ratio of the thrust coefficient and the power coefficient. The power coefficient asymptotic values increase significantly, being equal to the current density coefficient, as the mean flow value increases whereas the thrust coefficient undergoes a less significant increase.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ehd_scaling/CTP-480.webp 480w,/assets/img/posts/ehd_scaling/CTP-800.webp 800w,/assets/img/posts/ehd_scaling/CTP-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/ehd_scaling/CTP.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="CTP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>The figure shows the behavior of the thrust-to-power coefficient as a function of the dimensionless voltage and for different convective term values. It is possible to conclude that the 1D model predicts a substantial loss in the thrust to power. This is also worsened by the presence of aerodynamic drag which reduces the generated thrust.</p> <hr/> <p>These results are of critical importance for any future application of this technology. A reduction of the total thrust to power means that, for a given power requirement, the thruster will be able to generate less thrust as the velocity increases greatly limiting the speed of ionic thrusters. —</p> <p>It is useful to note that the exact same results are obtained by studying a similar problem, i.e. the one of a thruster in variable atmospheric conditions. In this case, however, the scaling to be followed is the one indicated by my article</p> <div class="publications"> <h2 class="year">2023</h2> <ol class="bibliography"><li> <div class="row"> <div class="col-sm-2 preview"> <figure> <picture> <img src="/assets/img/publication_preview/elsat2023.gif" class="preview z-depth-1 rounded" width="auto" height="auto" alt="elsat2023.gif" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div id="Kahol2023" class="col-sm-8"> <div class="title">Scaling relations for the geometry of wire-to-airfoil atmospheric ionic thrusters</div> <div class="author"> <em>Omar Kahol</em>, Marco Belan, Mattia Pacchiani, and <span class="more-authors" title="click to view 1 more author" onclick=" var element=$(this); element.attr('title', ''); var more_authors_text=element.text() == '1 more author' ? 'Domenico Montenero' : '1 more author'; var cursorPosition=0; var textAdder=setInterval(function(){ element.text(more_authors_text.substring(0, cursorPosition + 1)); if (++cursorPosition == more_authors_text.length){ clearInterval(textAdder); } }, '10'); ">1 more author</span> </div> <div class="periodical"> <em>Journal of Electrostatics</em>, 2023 </div> <div class="periodical"> </div> <div class="links"> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> </div> <div class="badges"> <span class="altmetric-embed" data-hide-no-mentions="true" data-hide-less-than="15" data-badge-type="2" data-badge-popover="right" data-doi="https://doi.org/10.1016/j.elstat.2023.103815"></span> <span class="__dimensions_badge_embed__" data-doi="https://doi.org/10.1016/j.elstat.2023.103815" data-hide-zero-citations="true" data-style="small_rectangle" data-legend="hover-right" style="margin-bottom: 3px;"></span> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@article</span><span class="p">{</span><span class="nl">Kahol2023</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Scaling relations for the geometry of wire-to-airfoil atmospheric ionic thrusters}</span><span class="p">,</span>
  <span class="na">journal</span> <span class="p">=</span> <span class="s">{Journal of Electrostatics}</span><span class="p">,</span>
  <span class="na">volume</span> <span class="p">=</span> <span class="s">{123}</span><span class="p">,</span>
  <span class="na">pages</span> <span class="p">=</span> <span class="s">{103815}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2023}</span><span class="p">,</span>
  <span class="na">issn</span> <span class="p">=</span> <span class="s">{0304-3886}</span><span class="p">,</span>
  <span class="na">doi</span> <span class="p">=</span> <span class="s">{https://doi.org/10.1016/j.elstat.2023.103815}</span><span class="p">,</span>
  <span class="na">url</span> <span class="p">=</span> <span class="s">{https://www.sciencedirect.com/science/article/pii/S0304388623000244}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Kahol, Omar and Belan, Marco and Pacchiani, Mattia and Montenero, Domenico}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li></ol> </div> <p>In this case, however,</p> \[R_v = \dfrac{1}{\mu_q}\sqrt{\dfrac{\epsilon_0}{\rho}}\] <p>An increase in \(R_v\) can be obtained by a decrease in the air density or the ion mobility. This will produce the same effects described above.</p>]]></content><author><name></name></author><category term="EHD"/><summary type="html"><![CDATA[An extension of the scaling model, for the drift region equations of EHD, with the introduction of external convection]]></summary></entry></feed>